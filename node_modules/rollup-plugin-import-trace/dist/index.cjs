"use strict";var h=Object.defineProperty;var r=(e,c)=>h(e,"name",{value:c,configurable:!0});const f="    ",m=r(e=>`

Import trace:
${e.map((c,n)=>`${n===0?f:`${f}\u21B3 `}${c}`).join(`
`)}
`,"formatTrace"),l=r(e=>{typeof e=="object"&&e!==null&&"message"in e&&typeof e.message=="string"&&"importTrace"in e&&Array.isArray(e.importTrace)&&(e.message+=m(e.importTrace))},"patchErrorWithTrace"),T=r(()=>{const e=new Map,c=r(t=>t.id??t.loc?.file,"getErrorFile"),n=r(t=>{const i=[];let s=t;const o=new Set;for(;s&&!o.has(s);)o.add(s),i.unshift(s),s=e.get(s);return i},"getTrace"),a=r((t,i=new Set)=>{if(!t?.id||i.has(t.id))return[];if(i.add(t.id),t.importers.size===0)return[t.id];const s=[...t.importers][0];return[...a(s,i),t.id]},"getViteTrace");return{name:"import-trace",configureServer(t){return()=>{t.middlewares.use((i,s,o,u)=>{const p=c(i);if(p){const g=t.moduleGraph.getModuleById(p),d=a(g);d.length>1&&(i.message+=m(d))}u(i)})}},buildStart:r(()=>{e.clear()},"buildStart"),moduleParsed(t){for(const i of t.importedIds)e.has(i)||e.set(i,t.id);for(const i of t.dynamicallyImportedIds)e.has(i)||e.set(i,t.id)},buildEnd(t){if(!t)return;const i=c(t);if(i){const s=n(i);s.length>1&&(t.importTrace=s)}}}},"importTrace");exports.importTrace=T,exports.patchErrorWithTrace=l;
